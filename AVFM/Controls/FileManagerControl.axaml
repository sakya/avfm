<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="clr-namespace:AVFM.Controls"
             xmlns:i="clr-namespace:Projektanker.Icons.Avalonia;assembly=Projektanker.Icons.Avalonia"
             xmlns:i18n="clr-namespace:AVFM.Localizer"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="AVFM.Controls.FileManagerControl"
             GotFocus="OnGotFocus">

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>

      <StackPanel Orientation="Horizontal">
        <Button Name="m_GoBack" Click="OnGoBackClicked" Focusable="False" Height="32" i:Attached.Icon="fas fa-arrow-left" />
        <Button Name="m_GoForward" Click="OnGoForwardClicked" Focusable="False" Height="32" i:Attached.Icon="fas fa-arrow-right" />
        <Button Name="m_GoUp" Click="OnUpClicked" Height="32" Focusable="False" i:Attached.Icon="fas fa-arrow-up" />
        <Button Click="OnHomeClicked" Margin="5,0,0,0" Height="32" Focusable="False" i:Attached.Icon="fas fa-home" ToolTip.Tip="{i18n:Localize Home}" />
      </StackPanel>

      <TextBox Name="m_PositionTextBox" Grid.Column="1" VerticalAlignment="Center" Text="{Binding FullPath}" />

      <Button Click="OnRefreshClicked" Grid.Column="2" Height="32" Focusable="False" i:Attached.Icon="fas fa-redo-alt" ToolTip.Tip="{i18n:Localize Refresh}" />
      <Button Click="OnRootClicked" Grid.Column="3" Height="32" Focusable="False" ToolTip.Tip="{i18n:Localize Root}">
        <i:Icon Value="fas fa-minus">
          <i:Icon.RenderTransform>
            <RotateTransform Angle="-45" />
          </i:Icon.RenderTransform>
        </i:Icon>
      </Button>
      <Button Click="OnBookmarksClicked" Name="m_BookmarksBtn" Grid.Column="4" Height="32" Focusable="False" Margin="5,0,0,0" i:Attached.Icon="far fa-bookmark"/>
      <Popup Name="m_BookmarksPopup"
             PlacementTarget="m_BookmarksBtn" Placement="AnchorAndGravity" PlacementGravity="BottomLeft">
        <Border Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
                CornerRadius="3" Padding="0,3,0,3" Margin="0,15,0,0">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto" />
              <RowDefinition Height="Auto" />
              <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Button Margin="5,5,5,0" HorizontalAlignment="Stretch"
                    Click="OnAddBookmarkClicked">
              <StackPanel Orientation="Horizontal">
                <i:Icon Value="fas fa-asterisk" />
                <TextBlock Text="{i18n:Localize AddBookmark}" VerticalAlignment="Center" Margin="5,0,0,0" />
              </StackPanel>
            </Button>
            <Button Grid.Row="1" Margin="5,5,5,5" HorizontalAlignment="Stretch">
              <StackPanel Orientation="Horizontal">
                <i:Icon Value="fas fa-edit" />
                <TextBlock Text="{i18n:Localize EditBookmarks}" VerticalAlignment="Center" Margin="5,0,0,0" />
              </StackPanel>
            </Button>
            <ListBox Name="m_BookmarksList" Grid.Row="2" ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                     Width="250" MaxHeight="500" Background="Transparent"
                     SelectionChanged="OnSelectedBookmarkChanged">
              <ListBox.Styles>
                  <Style Selector="ListBoxItem">
                      <Setter Property="Padding" Value="9,0,9,0"/>
                  </Style>
              </ListBox.Styles>
              <ListBox.ItemTemplate>
                  <DataTemplate>
                      <Grid>
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="Auto" />
                          <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <i:Icon Value="{Binding Icon}" Foreground="{DynamicResource SystemAccentBrush}" VerticalAlignment="Center" Height="32" Margin="0,0,5,0" />
                        <TextBlock Grid.Column="1" Text="{Binding Name}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                      </Grid>
                  </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>
          </Grid>
        </Border>
      </Popup>
    </Grid>

    <controls:FileListingControl Name="m_FileListing" Grid.Row="1" Focusable="True"
                                 ViewMode="List"
                                 KeyboardNavigation.IsTabStop="False" />

    <TextBox Name="m_FilterTextbox" Grid.Row="2" IsVisible="False" />
    <TextBlock Name="m_Status" VerticalAlignment="Center" TextTrimming="CharacterEllipsis" Grid.Row="3" Margin="0,5,0,5" />
  </Grid>
</UserControl>
